---
title: Crystal 1.4.0 is released!
version: 1.4.0
summary:
thumbnail: +
author:
---

We are delivering a new release with several bugfixes and improvements. Below we list the most important or interesting changes, without mentioning several bugfixes and smaller enhancements. For more details, visit the [changelog](https://github.com/crystal-lang/crystal/releases/tag/1.4.0). Breaking changes are marked with ⚠️.

Pre-built packages are available on [GitHub Releases](https://github.com/crystal-lang/crystal/releases/tag/1.4.0) and our official distribution channels.
See [crystal-lang.org/install](https://crystal-lang.org/install/) for installation instructions.

## Stats

In this release we included [132 changes since the 1.3.2 release](https://github.com/crystal-lang/crystal/pulls?q=is%3Apr+milestone%3A1.4.0) by ?? contributors. We thank all the effort put into improving the language! ❤️

## Towards WASM support

Version 1.4.0 ships with, at the moment, minimal support for compiling into WebAssembly, linking it with a WASI-based LibC. There are several missing important pieces, check the [PR](https://github.com/crystal-lang/crystal/pull/10870). The updated instructions to try it out are:

1. Write a simple Crystal program, let's say: 
```crystal
puts "Hello WebAssembly!"
```
and name it `main.cr`.
You can also try more complicated programs, but keep in mind that this is still experimental
and not ready for production.

2. You need to have `wasm-ld` installed on your system, it is the WebAssembly linker from LLVM.
On some systems, it comes by installing `lld`. Confirm that it is installed by using
`wasm-ld --version`. Please also check that its version is similar to Crystal's LLVM version
(`crystal --version`).

3. You will need `libc` and `libpcre` compiled to the `wasm32-wasi` target. You can fetch a
precompiled version of them [here](https://github.com/lbguilherme/wasm-libs/releases).
Check for the `wasm32-wasi-libs.tar.gz` asset, download it and extract it.

4. Cross-compile it with `crystal build main.cr --cross-compile --target wasm32-wasi`.

5. Link it with
```bash
wasm-ld main.wasm -o main-final.wasm  -L "$PWD/wasm32-wasi-libs" -lc -lpcre -lclang_rt.builtins-wasm32
```

6. Run the WebAssembly module with `wasmer main-final.wasm` or `wasmtime main-final.wasm` and have fun.

Note: There is currently a [PR](https://github.com/crystal-lang/crystal/pull/11948) that will simplify steps 4 and 5 above.

## Better inference of instance and class variables

Previous to this release, a simple program like the following failed to type because it couldn't infer the type of the instance variable:

```crystal
class DisplayHello
  DELAY = 10.milliseconds

  @timer_countdown = DELAY
end
```

Now it compiles fine, inferring correctly that `@timer_countdown` has type `Time::Span`. It is also possible to omit types in other cases too ([details](https://github.com/crystal-lang/crystal/pull/11812)):

```crystal
class DisplayHello

  def initialize(delay : Time::Span)
    @timer_countdown = delay + 10.seconds
  end
end
```


## Other notable changes

- Support for LLVM 14 ([PR](https://github.com/crystal-lang/crystal/pull/11905)).
- Completed support for `Int128` ([PR](https://github.com/crystal-lang/crystal/pull/11576)).
- ⚠️ Support for scientific notation in `BigFloat#to_s` ([details](https://github.com/crystal-lang/crystal/pull/10632)).
- ⚠️ Drop support of undocumented flag `skip_abstract_def_check` ([details](https://github.com/crystal-lang/crystal/pull/9217)).

---
We have been able to do all of this thanks to the continued support of [84codes](https://www.84codes.com/), [Nikola Motor Company](https://nikolamotor.com/) and every other [sponsor](/sponsors). To maintain and increase the development pace, donations and sponsorships are essential. [OpenCollective](https://opencollective.com/crystal-lang) is available for that. Reach out to [crystal@manas.tech](mailto:crystal@manas.tech) if you’d like to become a direct sponsor or find other ways to support Crystal. We thank you in advance!
