---
title: Crystal 1.18.0 is released!
version: 1.18.0
date: 2025-10-14
author: straight-shoota
---

We are announcing a new Crystal release 1.18.0 with several new features and bug
fixes.

Pre-built packages are available on [GitHub
Releases](https://github.com/crystal-lang/crystal/releases/tag/1.18.0) and our
official distribution channels. See
[crystal-lang.org/install](https://crystal-lang.org/install/) for installation
instructions.

## Stats

This release includes [XX changes since
1.17.1](https://github.com/crystal-lang/crystal/pulls?q=is%3Apr+milestone%3A1.18.0)
by XX contributors.  We thank all the contributors for all the effort put into
improving the language! ❤️

## Changes

Below we list the most remarkable changes in the language, compiler and stdlib.
For more details, visit the [full
changelog](https://github.com/crystal-lang/crystal/releases/tag/1.18.0).

We do not expect any breaking changes in existing code. If you notice any
unexpected issues, please let us know in the [issue tracker] or [forum].

### Execution contexts

Execution contexts from [RFC 0002] continue as a preview feature with opt-in
with compiler flags `-Dpreview_mt -Dexecution_context`. It might move out of
preview in the next release.

The default execution context is now parallel, but with `maximum: 1`
([#16136]).
So it starts with a single thread, but it can grow to more with
[`Fiber::ExecutionContext::Parallel#resize`] ([#15956]).

There are also a number of performance improvements for schedulers and event
loops ([#15961], [#16063]) and we dropped the custom implementation of
[`Fiber::ExecutionContext::Concurrent`] ([#16135]). It's now based on the parallel
implementation.

[`Fiber::ExecutionContext.default_workers_count`] has been improved ([#16149]) to
respect the effective CPU count available to the process ([#16148]).

The preview of synchronization primitives in [`ysbaddaden/sync`] has seen some
improvements as well.

_This effort is part of the [ongoing project to improve multi-threading support]
with the help of [84codes]._

_Thanks, [@ysbaddaden]_

[RFC 0002]: https://github.com/crystal-lang/rfcs/pull/2
[ongoing project to improve multi-threading support]: /2024/02/09/84codes-manas-mt/
[`Fiber::ExecutionContext::Parallel#resize`]: https://crystal-lang.org/api/1.18.0/Fiber/ExecutionContext/Parallel.html#resize(maximum:Int32):Nil-instance-method
[`Fiber::ExecutionContext::Concurrent`]: https://crystal-lang.org/api/1.18.0/Fiber/ExecutionContext/Concurrent.html
[`Fiber::ExecutionContext.default_workers_count`]: https://crystal-lang.org/api/1.18.0/Fiber/ExecutionContext.html#default_workers_count:Int32-class-method
[`ysbaddaden/sync`]: https://github.com/ysbaddaden/sync/
[#16136]: https://github.com/crystal-lang/crystal/issues/16136
[#15956]: https://github.com/crystal-lang/crystal/issues/15956
[#15961]: https://github.com/crystal-lang/crystal/issues/15961
[#16063]: https://github.com/crystal-lang/crystal/issues/16063
[#16135]: https://github.com/crystal-lang/crystal/issues/16135
[#16149]: https://github.com/crystal-lang/crystal/issues/16149
[#16148]: https://github.com/crystal-lang/crystal/issues/16148

### Deprecation warnings

Deprecation warnings are now available on types and aliases ([#15962]) as well
as individual method parameters ([#15999]).
Deprecated types only trigger warning when they are actually _used_ (e.g.
calling a class method), not when they're just part of type restriction, for
example.
Deprecated parameters only trigger a warning when the particular parameter is
used in a call. Calls without this parameter are unaffected.

```cr
@[Deprecated("Here may be dragons")]
class Foo
end

def foo(bar, @[Deprecated("Do not try this at home")] baz)
end
```

_Thanks [@ysbaddaden]_

[#15962]: https://github.com/crystal-lang/crystal/issues/15962
[#15999]: https://github.com/crystal-lang/crystal/issues/15999

### Time

#### `Time#inspect`

The format of [`Time#inspect`] has been adjusted slightly to align with the Internet
Extended Date/Time Format (IXDTF) defined in [RFC 9557] ([#16039]).

Changes from the previous format:

- Replace `UTC` location by `Z` offset
- Skip zero nanoseconds entirely even when `with_nanoseconds` is true (see https://github.com/crystal-lang/crystal/pull/16039#discussion_r2250863021)
- Remove whitespace between time and offset
- Wrap location in square brackets to indicate an IXDTF time-zone suffix

Some examples show the differences:

```cr
a = Time.utc(2014, 1, 2, 3, 4, 5, nanosecond: 123_456_789)
b = Time.local(2014, 1, 2, 3, 4, 5, nanosecond: 123_456_789, location: Time::Location.load("Europe/Berlin"))
c = Time.local(2014, 1, 2, 3, 4, 5, nanosecond: 123_456_789, location: Time::Location.fixed(3600))

# Crystal 1.17:
a.inspect # => "2014-01-02 03:04:05.123456789 UTC"
b.inspect # => "2014-01-02 03:04:05.123456789 +01:00 Europe/Berlin"
c.inspect # => "-2014-01-02 03:04:05.123456789 +01:00"

# Crystal 1.18:
a.inspect # => "2014-01-02 03:04:05.123456789Z"
b.inspect # => "2014-01-02 03:04:05.123456789+01:00[Europe/Berlin]"
c.inspect # => "+2014-01-02 03:04:05.123456789+01:00"
```

[`Time#inspect`]: https://crystal-lang.org/api/1.18.0/Time.html#inspect(io:IO,with_nanoseconds=true):Nil-instance-method
[#16039]: https://github.com/crystal-lang/crystal/issues/16039

### `Time::Location`

[`Time::Location.local`] now follows symlink names, so that it resolves to the same
timezone by name as [`Time::Location.load`], even if `/etc/localtime` points to a
zoneinfo database ([#16002], [#16022]).

[`Time::Location.load?`] is a new, non-raising variant to `.load` ([#16121]).

_Thanks, [@straight-shoota]_

The local Windows system time zone now uses the canonical IANA name ([#15967]).

_Thanks, [@HertzDevil]_

[RFC 9557]: https://datatracker.ietf.org/doc/html/rfc9557

[`Time::Location.local`]: https://crystal-lang.org/api/1.18.0/Time.html#local(year:Int32,month:Int32,day:Int32,hour:Int32=0,minute:Int32=0,second:Int32=0,*,nanosecond:Int32=0,location:Location=Location.local):Time-class-method
[`Time::Location.load`]: https://crystal-lang.org/api/1.18.0/Time/Location.html#load(name:String):Location-class-method
[`Time::Location.load?`]: https://crystal-lang.org/api/1.18.0/Time/Location.html#load?(name:String):Location%7CNil-class-method
[#16002]: https://github.com/crystal-lang/crystal/issues/16002
[#16022]: https://github.com/crystal-lang/crystal/issues/16022
[#16121]: https://github.com/crystal-lang/crystal/issues/16121
[#15967]: https://github.com/crystal-lang/crystal/issues/15967

### Serialization

[`YAML::Any`] now resolves YAML aliases ([#15941]).

_Thanks, [@willhbr]_

The output of [`JSON::Any#inspect`] got a wrapper to indicate
the `Any` type and differentiate from the wrapped type ([#15979]).
The equivalent for `YAML::Any` is still pending.

```cr
require "json"

JSON::Any.new(1).inspect # => "JSON::Any(1)"
```

_Thanks, [@jneen]_

[`Time::Location`] can now be used as a JSON object key ([#15957]).

_Thanks, [@Sija]_

The private constructors of `*::Serializable` moved into the `macro included`
hook ([#16147]). They're now defined on the including types which is more robust
in terms of `#initialize` overload ordering. This also allows referring generic
type variables inside converters.

_Thanks, [@HertzDevil]_

[`YAML::Any`]: https://crystal-lang.org/api/1.18.0/YAML/Any.html
[`JSON::Any#inspect`]: https://crystal-lang.org/api/1.18.0/JSON/Any.html#inspect(io:IO):Nil-instance-method
[`Time::Location`]: https://crystal-lang.org/api/1.18.0/Time/Location.html
[#15941]: https://github.com/crystal-lang/crystal/issues/15941
[#15979]: https://github.com/crystal-lang/crystal/issues/15979
[#15957]: https://github.com/crystal-lang/crystal/issues/15957
[#16147]: https://github.com/crystal-lang/crystal/issues/16147

### Standard library

New methods:

- [`Set#select!`] and [`#reject!`] ([#16060])
- [`File.readlink?`] ([#16004])
- [`SemanticVersion.valid?`] & [`SemanticVersion.parse?`] ([#15051])
- [`Socket.set_blocking`] and [`IO::FileDescriptor#set_blocking`] ([#16033], [#16129])
- [`OptionParser#summary_width`] and [`OptionParser#summary_indent`] ([#15326])

_Thanks, [@HertzDevil], [@straight-shoota], [@devnote-dev], [@ysbaddaden], [@kojix2]_

[`Colorize`] now uses scoped ANSI reset codes which only reset the respective
property, instead of resetting _everything_ ([#16052]).

_Thanks, [@Blacksmoke16]_

[`Set#select!`]: https://crystal-lang.org/api/1.18.0/Set.html#select%21%28%26%3AT-%3E%29%3Aself-instance-method
[`#reject!`]: https://crystal-lang.org/api/1.18.0/Set.html#reject!(&:T-%3E):self-instance-method
[`File.readlink?`]: https://crystal-lang.org/api/1.18.0/File.html#readlink?(path:Path%7CString):String%7CNil-class-method
[`SemanticVersion.valid?`]: https://crystal-lang.org/api/1.18.0/SemanticVersion.html#valid?(str:String):Bool-class-method
[`SemanticVersion.parse?`]: https://crystal-lang.org/api/1.18.0/SemanticVersion.html#parse%3F%28str%3AString%29%3Aself%7CNil-class-method
[`Socket.set_blocking`]: https://crystal-lang.org/api/1.18.0/Socket.html#set_blocking(fd:Handle,value:Bool)-class-method
[`IO::FileDescriptor#set_blocking`]: https://crystal-lang.org/api/1.18.0/Socket.html#set_blocking(fd:Handle,value:Bool)-class-method
[`OptionParser#summary_width`]: https://crystal-lang.org/api/1.18.0/OptionParser.html#summary_width:Int32-instance-method
[`OptionParser#summary_indent`]: https://crystal-lang.org/api/1.18.0/OptionParser.html#summary_indent:String-instance-method
[`Colorize`]: https://crystal-lang.org/api/1.18.0/Colorize.html
[#16060]: https://github.com/crystal-lang/crystal/issues/16060
[#16004]: https://github.com/crystal-lang/crystal/issues/16004
[#15051]: https://github.com/crystal-lang/crystal/issues/15051
[#16033]: https://github.com/crystal-lang/crystal/issues/16033
[#16129]: https://github.com/crystal-lang/crystal/issues/16129
[#15326]: https://github.com/crystal-lang/crystal/issues/15326
[#16052]: https://github.com/crystal-lang/crystal/issues/16052

### Networking

[`StaticFileHandler`] preserves query params in redirects ([#15789])

_Thanks, [@syeopite]_

[`StaticFileHandler`] returns 404 on file error ([#16025], [#16077])

_Thanks, [@straight-shoota]_

`HTTP::Client` runs the [`#before_request`] callback only once, even if a
request is retried ([#16064]).

_Thanks [@straight-shoota]_

[`URI#host=`] wraps IPv6 addresses in brackets ([#16164])

_Thanks, [@stakach]_

[`StaticFileHandler`]: https://crystal-lang.org/api/1.18.0/HTTP/StaticFileHandler.html
[`#before_request`]: https://crystal-lang.org/api/1.18.0/HTTP/Client.html#before_request%28%26callback%3AHTTP%3A%3ARequest-%3E%29%3ANil-instance-method
[`URI#host=`]: https://crystal-lang.org/api/1.18.0/URI.html#host=(host:String%7CNil)-instance-method
[#15789]: https://github.com/crystal-lang/crystal/issues/15789
[#16025]: https://github.com/crystal-lang/crystal/issues/16025
[#16077]: https://github.com/crystal-lang/crystal/issues/16077
[#16064]: https://github.com/crystal-lang/crystal/issues/16064
[#16164]: https://github.com/crystal-lang/crystal/issues/16164

### Type restrictions

We added type restrictions to many API methods. This improves the documentation
This is a semi-automatic effort, assisted by a tool that automatically extracts
typing information from the semantic analysis of a program ([#15682]).

[`MIME`] ([#15834]), [`Log`] ([#15777]), [`OAuth`] ([#15687]), [`JSON`] ([#15840],
[#16142]), [`Benchmark`] ([#15688]), [`Crypto`] ([#15694]), [`IO`] ([#15698]), [`HTTP`]
([#15710]), `Big*` ([#15689]), [`Process`] ([#16031]).

_Thanks, [@Vici37]_

[`MIME`]: https://crystal-lang.org/api/1.18.0/MIME.html
[`Log`]: https://crystal-lang.org/api/1.18.0/Log.html
[`OAuth`]: https://crystal-lang.org/api/1.18.0/OAuth.html
[`JSON`]: https://crystal-lang.org/api/1.18.0/JSON.html
[`Benchmark`]: https://crystal-lang.org/api/1.18.0/Benchmark.html
[`Crypto`]: https://crystal-lang.org/api/1.18.0/Crypto.html
[`IO`]: https://crystal-lang.org/api/1.18.0/IO.html
[`HTTP`]: https://crystal-lang.org/api/1.18.0/HTTP.html
[`Process`]: https://crystal-lang.org/api/1.18.0/Process.html
[#15682]: https://github.com/crystal-lang/crystal/issues/15682
[#15834]: https://github.com/crystal-lang/crystal/issues/15834
[#15777]: https://github.com/crystal-lang/crystal/issues/15777
[#15687]: https://github.com/crystal-lang/crystal/issues/15687
[#15840]: https://github.com/crystal-lang/crystal/issues/15840
[#16142]: https://github.com/crystal-lang/crystal/issues/16142
[#15688]: https://github.com/crystal-lang/crystal/issues/15688
[#15694]: https://github.com/crystal-lang/crystal/issues/15694
[#15698]: https://github.com/crystal-lang/crystal/issues/15698
[#15710]: https://github.com/crystal-lang/crystal/issues/15710
[#15689]: https://github.com/crystal-lang/crystal/issues/15689
[#16031]: https://github.com/crystal-lang/crystal/issues/16031

### Code Cleanup

Multi-line strings containing source code in compiler specs have had two
different formats: Some of them were using regular string literals, others used
heredocs. The latter was usually preferred in new code additions because
line numbers and indents are more sensible. And with an appropriate heredoc
identifier to denote the language, we even get nested syntax highlighting.
In this release we've converted all compiler specs to use heredocs
([#11291]).

_Thanks, [@HertzDevil]_

With the help of `ameba`, we've enabled and applied a couple more linter rules:
`Style/UnlessElse` ([#16010]), `Style/RedundantBegin` ([#16011]), and
`Lint/UselessAssign` ([#16014]).

_Thanks, [@straight-shoota]_

[#11291]: https://github.com/crystal-lang/crystal/issues/11291
[#16010]: https://github.com/crystal-lang/crystal/issues/16010
[#16011]: https://github.com/crystal-lang/crystal/issues/16011
[#16014]: https://github.com/crystal-lang/crystal/issues/16014

### Macros

New methods:

- [`ArrayLiteral#*`], [`TupleLiteral#*`] and [`StringLiteral#*`] ([#16154])
- [`NumberLiteral#zero?`] ([#10248])

_Thanks, [@jneen], [@Sija]_

Empty [`NamedTupleLiteral`] and [`TupleLiteral`] expand to `NamedTuple.new` and
`Tuple.new`, instead of `{}` ([#16108]).

_Thanks, [@spuun]_

[`ArrayLiteral#*`]: https://crystal-lang.org/api/1.18.0/Crystal/Macros/ArrayLiteral.html#*(other:NumberLiteral):ArrayLiteral-instance-method
[`TupleLiteral#*`]: https://crystal-lang.org/api/1.18.0/Crystal/Macros/TupleLiteral.html#*(other:NumberLiteral):TupleLiteral-instance-method
[`StringLiteral#*`]: https://crystal-lang.org/api/1.18.0/Crystal/Macros/StringLiteral.html#*(other:NumberLiteral):StringLiteral-instance-method
[`NumberLiteral#zero?`]: https://crystal-lang.org/api/1.18.0/Crystal/Macros/NumberLiteral.html#zero%3F%3ABoolLiteral-instance-method
[`NamedTupleLiteral`]: https://crystal-lang.org/api/1.18.0/Crystal/Macros/NamedTupleLiteral.html
[`TupleLiteral`]: https://crystal-lang.org/api/1.18.0/Crystal/Macros/TupleLiteral.html
[#16154]: https://github.com/crystal-lang/crystal/issues/16154
[#10248]: https://github.com/crystal-lang/crystal/issues/10248
[#16108]: https://github.com/crystal-lang/crystal/issues/16108

### Compiler

The compiler can dump type information to a JSON file when the environment
variable `CRYSTAL_DUMP_TYPE_INFO` is set ([#16027]).

_Thanks, [@HertzDevil]_

Resolve types when guessing return type from class method overloads ([#16118]).

In the following snippet, the compiler is able to infer `@foo`'s type to be `Foo`, since both overloads of `Foo.foo` have a return type of `Foo`:

```crystal
class Foo
  def self.foo(x : Int32) : Foo
    new
  end

  def self.foo(x : String) : Foo
    new
  end
end

class Bar
  def initialize
    @foo = Foo.foo(1)
  end
end

Bar.new
```

_Thanks, [@HertzDevil]_

Guess instance variable types from global method calls ([#16119]).

This allows the following to compile:

```crystal
def foo(x : Int32) : Float64
  # ...
end

class Bar
  def initialize
    @foo = ::foo(1) # okay, `@foo` has the type `Float64`
  end
end
```

The call needs to be global; other than that, type guessing for top-level methods has the same limitations as for class methods.

_Thanks, [@HertzDevil]_

Hash literals are evaluated from left to right, fixing a regression from 1.6.0 ([#16124]).

_Thanks, [@HertzDevil]_

Temporary variables are now grouped by file name in order to increase the chance
of reusing previous macro expansions ([#16122]).

_Thanks, [@HertzDevil]_

[#16027]: https://github.com/crystal-lang/crystal/issues/16027
[#16118]: https://github.com/crystal-lang/crystal/issues/16118
[#16119]: https://github.com/crystal-lang/crystal/issues/16119
[#16124]: https://github.com/crystal-lang/crystal/issues/16124
[#16122]: https://github.com/crystal-lang/crystal/issues/16122

### Interpreter

- Fully exit the process on `exit!` from REPL ([#16171])
- Fixed interpreter hanging on the signal pipe ([#16167])

_Thanks [@jneen], [@straight-shoota]_

[#16171]: https://github.com/crystal-lang/crystal/issues/16171
[#16167]: https://github.com/crystal-lang/crystal/issues/16167

### Infra

- `REUSE.toml` describes which licenses apply to which parts of the code base,
  following the [Reuse Software Specification] ([#15992])
- Default to LLVM 16 in `shell.nix` ([#16023])

_Thanks [@straight-shoota], [@HertzDevil]_

[Reuse Software Specification]: https://reuse.software/

[#15992]: https://github.com/crystal-lang/crystal/issues/15992
[#16023]: https://github.com/crystal-lang/crystal/issues/16023

### Dependencies

- Support for LLVM 21.1 and 22.0 ([#16062])
- Update Unicode to 17.0.0 ([#16160])

_Thanks [@HertzDevil], [@ysbaddaden]_

[#16062]: https://github.com/crystal-lang/crystal/issues/16062
[#16160]: https://github.com/crystal-lang/crystal/issues/16160

### Deprecations

- [`Socket#blocking`] and [`IO::FileDescriptor#blocking`] properties ([#16033], [#16129])
- [`Atomic::Flag`] ([#15805])
- The `blocking` parameter of [`File.new`], [`Socket.new`] and [`IO::FileDescriptor.new`] constructors ([#16034], [#16047])
- `Float::Printer::IEEE` ([#16050])
- [`Process::Status#exit_signal`] ([#16003])

_Thanks [@ysbaddaden], [@Blacksmoke16], [@HertzDevil], [@straight-shoota]_

[`Socket#blocking`]: https://crystal-lang.org/api/1.18.0/Socket.html#blocking-instance-method
[`IO::FileDescriptor#blocking`]: https://crystal-lang.org/api/1.18.0/IO/FileDescriptor.html#blocking:Bool-instance-method
[`Atomic::Flag`]: https://crystal-lang.org/api/1.18.0/Atomic/Flag.html
[`File.new`]: https://crystal-lang.org/api/1.18.0/File.html
[`Socket.new`]: https://crystal-lang.org/api/1.18.0/Socket.html
[`IO::FileDescriptor.new`]: https://crystal-lang.org/api/1.18.0/IO/FileDescriptor.html
[`Process::Status#exit_signal`]: https://crystal-lang.org/api/1.18.0/Process/Status.html#exit_signal:Signal-instance-method
[#15805]: https://github.com/crystal-lang/crystal/issues/15805
[#16034]: https://github.com/crystal-lang/crystal/issues/16034
[#16047]: https://github.com/crystal-lang/crystal/issues/16047
[#16050]: https://github.com/crystal-lang/crystal/issues/16050
[#16003]: https://github.com/crystal-lang/crystal/issues/16003

---

> **THANKS:**
>
> We have been able to do all of this thanks to the continued support of
> [84codes] and every other [sponsor](/sponsors). To maintain and increase the
> development pace, donations and sponsorships are essential.
> [OpenCollective](https://opencollective.com/crystal-lang) is available for
> that.
>
> Reach out to [crystal@manas.tech](mailto:crystal@manas.tech) if you’d like to
> become a direct sponsor or find other ways to support Crystal. We thank you in
> advance!

[issue tracker]: https://github.com/crystal-lang/crystal/issues
[forum]: https://forum.crystal-lang.org/
[84codes]: https://www.84codes.com/
[@Blacksmoke16]: https://github.com/Blacksmoke16
[@HertzDevil]: https://github.com/HertzDevil
[@Sija]: https://github.com/Sija
[@Vici37]: https://github.com/Vici37
[@devnote-dev]: https://github.com/devnote-dev
[@jneen]: https://github.com/jneen
[@kojix2]: https://github.com/kojix2
[@spuun]: https://github.com/spuun
[@stakach]: https://github.com/stakach
[@straight-shoota]: https://github.com/straight-shoota
[@syeopite]: https://github.com/syeopite
[@willhbr]: https://github.com/willhbr
[@ysbaddaden]: https://github.com/ysbaddaden
